# クラス名 と CSS 設計

CSS で正しくデザインを表現できたとしても、
一つのデザインを表現するための CSS の書き方は様々なものがあります。

複数人で作業を進める上では、わかりやすく、管理しやすい CSS の記述が必要不可欠です。

ここでは CSS 設計を通じて、読みやすい・保守性の高い CSS の書き方について考えていきます。
 
## SMACSS - CSS のレイヤを考える

デザインを一つの CSS に落とし込む上で、 CSS の構造について整理し理解するアプローチはとても重要です。

Web サイト全体を要素ごとに漠然とスタイリングすると、
不要な重複するコードが生まれたり、同じ意味合いのコードが複数箇所に分散したりと、
冗長で読みにくく、メンテナンスし辛いコードが出来上がってしまいます。

一口に CSS といってもその役割は様々で、構造に分けて捉える必要があります。
CSS の構造に関する便利な考え方として、SMACSS が提供する 5 つのカテゴリーが利用できます。

- `ベース`	要素そのもののデフォルトスタイル
- `レイアウト`	ページをエリアごとに分割するためのスタイル
- `モジュール`  再利用可能なパーツごとのスタイル
- `状態（ステート）`	レイアウトやモジュールの特定の状態を表現するスタイル
- `テーマ`	サイトのルック＆フィールを提供するスタイル

SMACSS(スマックス) は Scalable and Modular Architecture for CSS の略で、
「CSSをより体系立て、より構造化させることで制作とメンテナンスをより容易に行うテクニック」として
広く認知されている CSS 設計の考え方です。

[https://smacss.com/](https://smacss.com/)

SMACSS の概念に基づいて CSS を分割することで、
それぞれの CSS で定義すべき内容や役割が見えてくるはずです。

### ベース

サイト全体で利用される HTML 要素そのもののデフォルトのスタイルです。

Normalize.css などの リセット CSS と呼ばれるものもここに位置します。

ブラウザデフォルトの状態に依存するよりも、何らかの リセット CSS 導入しておくことで、
ブラウザごとの差異をなくしたり、コーディング上の指針を共通化することができるようになります。

### レイアウト

サイト全体で適用されるような グリッドやカラムなどの 大きなレイアウトの定義は、
詳細の CSS と分けて記述します。

個々の CSS 定義が レイアウトに依存する形で記述されてしまうと、レイアウトの変更に応じて、
個別のCSSを書き直すことになりかねません。

保守性を考える上でも、レイアウトに関するルールは 個別の CSS から極力分離しておくほうが良いでしょう。

### モジュール

再利用可能な ページ上で繰り返し利用される UI を定義します。

画面上で表示するボタンや アラートなどの項目は、ページ全体での表示方式を共通化するために、
同じクラス等を用いて表示を統一化するほうが良いでしょう。

### ステート 

ページ上で変化しうる状態を表現する CSS のクラスです。

トグルボタンや、ナビゲーションの選択状態など、ユーザの入力に応じて活性非活性が変化する `.is-active` や
バリデーションメッセージや、アラートなど、特定の条件を満たさない限り非表示とする `.is-hidden` などがこれに当たります。

### テーマ

サイト内で利用する 色やフォントなどの 見た目・雰囲気を構成する要素を テーマとして分割して管理します。

テーマを差し替えることにより、サイト全体の 雰囲気を微調整する事が可能になり、
CSS の再利用性・柔軟性が向上します。

### その他の CSS 

SMACSS によるカテゴリ分けの関心は、「デザインの中で繰り返されるパターンを体系立てる」ことに関心が置かれています。

実際の CSS を記述する上では、ここに要素単位の個別のレイアウトなど、再利用性のない個々のスタイリングが必要になるでしょう。

特に、要素が固有で持つべきマージンや 高さ・幅等の要素を、
モジュールや テーマとして再利用可能な状態に置いてしまうと、
CSS の再利用性が低下し、コーディングの柔軟性が損なわれます。

「何を共通化すべきで、何を共通化すべきでないか」をしっかり検討し、
デザイナー・顧客合わせて認識を統一することが、CSS の管理コスト低減に大きく貢献します。

## CSS におけるクラス命名の関心
 
CSS では HTML 上のようそにクラス名をつけて、クラス名の単位でデザインを適用します。

クラス名の管理はコード管理の上でとても重要であり、クラスの命名についての考え方が統一されていることは、
コード管理上とても重要なことです。

クラスの命名に関する考え方がバラバラだと、
不要なコードの重複が生まれたり、意図しないクラス名の再利用が行われり、といった問題が発生するでしょう。
 
クラスの命名 を考える上で 問題となる大きなテーマとして以下のようなものが挙げられます。

- クラス名は どのようなケースで再利用されるべきか、または再利用されるべきではないか
- 単一の HTML 要素はただ一つのクラスメイを持つべきか、複数のクラス名付を許容するか
- クラス名は 見た目を表す名前として命名されるか、セマンティックに命名されるか

こういったコーディング上の考え方の違いが一つのサイト内で統一されていないと、
サイト全体でのクラス名の考え方に大きなブレが生じ、コーディング上の支障をもたらしてくるでしょう。
 
まずは、要素の何に対してクラス名をつけるか、という点について考えてみましょう。

### デザインに対してつける

要素に適用されるデザインに対して 名前をつける方法

お問い合わせの赤いボタンの場合 `red` `bordered` などの クラス名がつく。

### UIに対してつける

要素がユーザに対して提供するページ上の機能に対して 名前をつける方法

お問い合わせの赤いボタンの場合 `btn` などの クラス名がつく。

### アウトラインに対してつける

要素の ページ上での意味合いに対して 名前をつける方法 

お問い合わせの赤いボタンの場合 `contact-action` などの クラス名がつく。

## 様々な CSS 設計 
 
### デザインに対して名前をつける考え方
 
`red` や `mt20` など CSS に直結するクラスを作成して、組み合わせて使う方法です。
 
わかりやすく、利用しやすい一方で共通のCSS部分のメンテナンスが難しく、
HTML 要素に付与されるクラスも多くなりがちと言った問題があります。
 
運用上の理由で、例えば `red` に `font-weight` が設定されてしまったり、
多様な赤を表現するために、`red` の他に `red2` `red3` などのクラスが生まれるなどの事故も起こりやすく、
管理がとても複雑になる、といった問題もあります。

また、デザインとHTMLコードは強固に結びついているため、
デザインの変更に対して、HTMLの修正も頻繁に起こりやすくなる傾向があります。

CSS を記述するような感覚で クラス名を付与して HTML のコーディングができるため、
感覚的には利用しやすく便利ですが、 CSS は 必要に応じて都度継ぎ足され、また既存の CSS 定義の修正もしずらく
複雑になりがちなため、大きなプロジェクトでは利用を避けるほうが良いでしょう。
 
### UIに対して名前をつける考え方
 
`btn` や `alerts` など ページ上のUI要素単位に名前をつけて管理する方法です。

サイト内で利用されているUI間で見た目が常に同じとなることが保証されるため、
コンポーネントベースでのデザインを表現する上でとても便利です。
 
逆にコンポーネントを意識しないデザインに置いて、
同じUIが、細部異なる見た目を持っている…といったケースでは対応が困難になってきます。

コンポーネントの設計を行っていたとしても、
同じボタン群で、色や大きさのバリエーションなどの違いがあるケースもあるため、
バリエーションの管理には工夫が必要です。

またレイアウト上の位置によって、同じ UI でも異なるマージンを持つケースも考えられます。
このようなレイアウト上の設計をどれだけ緻密に行い、顧客と共有できるかがコンポーネント設計の鍵となってくるでしょう。

デザインとHTMLコードの結びつきは比較的緩やかになっているため、
デザインの変更があっても、単純なUI上の見た目の変化はCSSのみの修正で実装できるでしょう。

一般的な CSS フレームワークなどはこの思想をベースに CSS が記述されています。
 
### OOCSSの考え方
 
OOCSS(Object Oriented CSS)は、CSS上でUIを表現する上での、クラス設計の考え方です。
 
OOCSS では、UIを構成する要素を、構造と見た目に分けて二つのクラスで見た目を管理します。

[http://oocss.org/](http://oocss.org/)
 
<p data-height="265" data-theme-id="0" data-slug-hash="aPjQZR" data-default-tab="css,result" data-user="mikakane" data-pen-title="aPjQZR" class="codepen">See the Pen <a href="https://codepen.io/mikakane/pen/aPjQZR/">aPjQZR</a> by mikakane (<a href="https://codepen.io/mikakane">@mikakane</a>) on <a href="https://codepen.io">CodePen</a>.</p>

例では、 `btn` クラスは、 ボタン要素の構造を、
`btn-red` `btn-blue` 要素は ボタン要素の見た目を提供しています。 

このように UI 要素の構造と見た目を分けて管理することで、一つの CSS 群から、
複数のバリエーションを表現する事が可能になります。

この考え方は SCSS における mixin の設計でも非常に重要なものとなりますので、
概念としてはしっかり理解しておくほうが良いでしょう。

### アウトラインに対して名前をつける考え方

アウトラインとは ページドキュメントの構成を指すものです。
 
アウトラインに対して名前をつける場合、
HTML上のクラスはそれぞれの文脈に応じて（たとえ同じ見た目であっても！）個別のクラス名が付与されるため、
クラス名の再利用はほとんどされなくなります。

「何が共通化されるべきで、何を共通化すべきでないか」の検討は、ときに非常に困難であるケースもあるため、
アウトラインベースでシンプルに クラスの命名を行う場合、
デザインの独立/再利用からなる複雑さは HTML 上から取り除かれます。

この場合、理論上はデザインをほとんど意識することなくHTMLコードを記述する事が可能となり、
情報・コンテンツに変更がない限り、デザインの変更に伴う HTML コードの修正も不要になります。

一方で、CSSの容量は大きくなりがちなため、SCSS の `@extend` を利用した工夫などが必要になるケースもあるでしょう。
見た目が同じでも異なるクラス名が利用されるため、サイト全体で統一した 色やサイズを利用したい場合に
SCSS の変数等を利用した管理も不可欠になってきます。

アウトラインベースで名前をつける考え方の設計としては ECSS の考え方が参考になります。

[http://ecss.io/](http://ecss.io/)
 
### BEM  
 
これまでの議論とはこの異なり、BEMはクラスの命名ルールに関する考え方を提供してくれるものです。

BEM は Block-Element-Modifier の略語で、CSS の命名を以下の形で考えます。
 
- 命名に関する要素を `Block` `Element` `Modifier`の３つで考える。
- `Block` は 要素の大きなグループを表す。
- `Element` は `Block` 内の 小要素を表す。
- `Modifier` は `Block` `Element` の状態を表現する。
- クラス名における `Block` `Element` `Modifier` は それぞれ適切な記号を用いて区切って表現される
- `Element` は単独で用いられる、 必ず `Block` とセットで表現される。

![](/images/sec3/github_captions.jpg)

[image from getbem.com](http://getbem.com/introduction/)
 
通常、 `BEM` では `block__element--modifier` の様に `__` `--` などの記号２つ分の区切り文字を用いて表現されるケースが多いようです。

### FLOCSSの考え方
 
FLOCSSはさまざまなCSSプロジェクトの中で、ECSSやUIベースのCSSなどを柔軟に実現するための
プロジェクト管理の手法です。
 
[https://github.com/hiloki/flocss](https://github.com/hiloki/flocss)

FLOCSS では CSS を以下のようなレイヤーに分けて記述します。
 
```text
- Foundation - reset/normalize/base...
- Layout - header/main/sidebar/footer...
- Object
    - Component - grid/button/form/media...
    - Project - articles/ranking/promo...
    - Utility - clearfix/display/margin...
```

`Foundation` や `Layout` は SMACSS における ベースやレイアウトの CSS を記述する箇所になります。

SMACSS で言うところの 再利用可能なモジュールは Component に、
その他の アウトラインアウトラインベースでのページ固有の CSS は Project に格納されます。

Layout については `l-` の、
Component の CSS と Project の CSS は それぞれ `c-` `p-` の接頭辞を用いて命名され、
HTML 上からも利用されるクラス名が どのようなレイヤーに位置するものかを簡単に理解することが可能です。

接頭辞以降のクラス名は 原則 BEM に沿って命名され、クラス間の Block Element のつながりもわかりやすくすることができます。

また、Utility として 軽微なスタイルの調整などを 記述する 汎用 CSS を定義することもでき、
コーディング上で必要に応じて `.mt10` などのヘルパークラスを定義する余地も用意されています。

## 詳細度の考え方

CSS を記述する上で、詳細度に関しても少し考慮する必要があります。

詳細度は CSS を適用する上での強さを表すセレクタの持つ数値です。
 
[https://developer.mozilla.org/ja/docs/Web/CSS/Specificity](https://developer.mozilla.org/ja/docs/Web/CSS/Specificity)
 
既存の CSS 記述を 別の CSS 定義を用いて後から上書き変更しようとした場合、
元の 詳細度よりも強い詳細度を用いる必要があります。

ID セレクタは、一般に非常に強い詳細度を持っているため、
クラス等で記述する CSS を用いてこれを上書きする事ができなくなってしまいます。

同様に `style` 属性を用いた直接のスタイル定義も、非常に強い詳細度を持つため、
他の CSS を用いてこれを上書き変更することができません。

クラスセレクタを利用したケースでも、子孫セレクタを用いた指定は、
継承を追うごとにどんどんと詳細度が高くなってしまいます。

<p data-height="265" data-theme-id="0" data-slug-hash="pqZBdY" data-default-tab="css,result" data-user="mikakane" data-pen-title="pqZBdY" class="codepen">See the Pen <a href="https://codepen.io/mikakane/pen/pqZBdY/">pqZBdY</a> by mikakane (<a href="https://codepen.io/mikakane">@mikakane</a>) on <a href="https://codepen.io">CodePen</a>.</p>

CSSセレクタにおける親子セレクタの深さ定義は、全体で上限を設ける方が良いでしょう。
